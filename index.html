<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ERIZONT</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: #000;
      color: #fff;
      display: flex;
      flex-direction: column;
      height: 100vh;
      overflow: hidden;
    }

    header {
      text-align: center;
      padding: 10px;
      font-size: 28px;
      font-weight: bold;
    }

    #container {
      display: flex;
      flex: 1;
      overflow: hidden;
    }

    #menu-esquerdo {
      width: 300px;
      background-color: #111;
      overflow-y: auto;
      padding: 10px;
      border-right: 1px solid #333;
    }

    #player-container {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 10px;
    }

    video {
      width: 100%;
      max-width: 90%;
      max-height: 360px;
      background-color: black;
      border: 3px solid #fff;
      border-radius: 8px;
    }

    .grupo-btn {
      background-color: #222;
      color: #fff;
      border: 1px solid #555;
      padding: 6px 10px;
      width: 100%;
      text-align: left;
      font-weight: bold;
      margin-top: 8px;
      border-radius: 4px;
      cursor: pointer;
    }

    .grupo-canais {
      display: none;
      padding-left: 10px;
      margin-top: 5px;
    }

    .grupo-canais button {
      display: block;
      width: 100%;
      text-align: left;
      padding: 5px 8px;
      margin: 2px 0;
      background: #222;
      color: #fff;
      border: 1px solid #666;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
    }

    #loading-bar {
      height: 5px;
      background: linear-gradient(to right, #0f0 0%, #0f0 100%);
      width: 0%;
      transition: width 0.5s ease;
    }

    #qrcode-container {
      margin-top: 10px;
      text-align: center;
    }

    #qrcode-container img {
      max-width: 100px;
      display: block;
      margin: 0 auto;
    }

    #qrcode-container p {
      margin-top: 5px;
      font-size: 14px;
      color: #fff;
    }

    footer {
      text-align: center;
      padding: 5px;
      font-size: 14px;
    }

    footer a {
      color: #00f;
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <header>ERIZONT</header>
  <div id="loading-bar"></div>
  <div id="container">
    <div id="menu-esquerdo"></div>
    <div id="player-container">
      <video id="player" controls autoplay></video>
      <div id="qrcode-container">
        <img src="qrcode.png" alt="QR Code de Doação">
        <p>Apoie o projeto com uma doação</p>
      </div>
    </div>
  </div>
  <footer>
    Suporte: <a href="mailto:erizontrevolution@gmail.com">erizontrevolution@gmail.com</a>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
  <script>
    const m3uUrl = "http://atmck.xyz:80/get.php?username=549098716&password=990251878&type=m3u_plus&output=mpegts";

    function atualizarBarra(percentual) {
      document.getElementById("loading-bar").style.width = percentual + "%";
    }

    async function carregarConteudo() {
      try {
        atualizarBarra(10);
        const res = await fetch(m3uUrl);
        atualizarBarra(30);
        const texto = await res.text();
        atualizarBarra(50);

        const grupos = {};
        const linhas = texto.split('\n');
        let nome = "", grupo = "", url = "";

        for (let i = 0; i < linhas.length; i++) {
          const linha = linhas[i].trim();
          if (linha.startsWith('#EXTINF')) {
            const match = linha.match(/#EXTINF:-1.*?group-title="(.*?)".*?,(.*)/);
            if (match) {
              grupo = match[1].trim();
              nome = match[2].trim();
            } else {
              grupo = "Desconhecido";
              nome = linha.split(',').pop();
            }
          } else if (linha.startsWith('http')) {
            url = linha;
            if (!grupos[grupo]) grupos[grupo] = [];
            grupos[grupo].push({ nome, url });
          }
        }

        atualizarBarra(70);
        const menu = document.getElementById("menu-esquerdo");
        menu.innerHTML = "";

        Object.keys(grupos).sort().forEach(grupo => {
          const btnGrupo = document.createElement("button");
          btnGrupo.className = "grupo-btn";
          btnGrupo.textContent = `${grupo} (${grupos[grupo].length})`;

          const divCanais = document.createElement("div");
          divCanais.className = "grupo-canais";

          grupos[grupo].forEach(canal => {
            const btn = document.createElement("button");
            btn.textContent = canal.nome;
            btn.onclick = () => tocarVideo(canal.url);
            divCanais.appendChild(btn);
          });

          btnGrupo.onclick = () => {
            divCanais.style.display = divCanais.style.display === "none" ? "block" : "none";
          };

          menu.appendChild(btnGrupo);
          menu.appendChild(divCanais);
        });
        atualizarBarra(100);
        setTimeout(() => atualizarBarra(0), 1000);

      } catch (e) {
        console.error("Erro ao carregar conteúdo:", e);
      }
    }

    function tocarVideo(url) {
      const video = document.getElementById('player');
      video.src = url;
      video.play();
    }

    carregarConteudo();
  </script>
</body>
</html>
